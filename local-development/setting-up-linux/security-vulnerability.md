# Security/Vulnerability in Node.js

This document will lay out the steps you can take to harden your Node.js/Express application against malicious attacks. The Node React Boilerplate project is set up with a baseline of security measures that should be considered for Node.js/Express applications. These security measures will be documented here and we will delve further into additional security measures that can be taken to protect against specific types of attacks.

Node.js and Express have seen widespread adoption so the security of both is crucial for the developer community. However, external NPM packages such as helmet are required to fill in many of the security gaps that are left open. Developers have to be vigilant about writing their code with security in mind. For example, inputs should always be validated and sanitized if necessary, and outputs should be escaped to prevent malicious code from being embedded on the page the user is viewing. Additionally, security vulnerabilities are constantly being discovered in NPM packages, so these have to be patched as soon as possible. This is easier said than done because some packages may have vulnerable dependencies that can't be reliably updated or the package itself may not have a patch.

### Node React Boilerplate

The helmet.js package is just a collection of 12 security middleware packages. The Node React Boilerplate is set up with the default settings for helmet, which includes the following 7 middleware packages:  


| Package | Description |
| :--- | :--- |
| [frameguard](https://helmetjs.github.io/docs/frameguard/) | Frameguard mitigates clickjacking attacks by setting the`X-Frame-Options`header. |
| [noSniff](https://helmetjs.github.io/docs/dont-sniff-mimetype) | The Don’t Sniff Mimetype middleware,`noSniff`, helps prevent browsers from trying to guess \(“sniff”\) the MIME type, which can have security implications. It does this by setting the`X-Content-Type-Options`header to`nosniff`. |
| [hidePoweredBy](https://helmetjs.github.io/docs/hide-powered-by) | The Hide Powered-By middleware removes the`X-Powered-By`header to make it slightly harder for attackers to see what potentially-vulnerable technology powers your site. |
| [xssFilter](https://helmetjs.github.io/docs/xss-filter) | The`xssFilter`middleware sets the`X-XSS-Protection`header to prevent reflected XSS attacks. |
| [dnsPrefetchControl](https://helmetjs.github.io/docs/dns-prefetch-control) | This middleware lets you disable browsers’ DNS prefetching by setting the`X-DNS-Prefetch-Control`header. |
| [ieNoOpen](https://helmetjs.github.io/docs/ienoopen) | This middleware sets the`X-Download-Options`to prevent Internet Explorer from executing downloads in your site’s context. |
| [hsts](https://helmetjs.github.io/docs/hsts/) | This module sets the`Strict-Transport-Security`header to keep your users on HTTPS. |

To install helmet in your project, run this command:

| `npminstallhelmet --save` |
| :--- |


Assuming that Express has already been installed, add this to your Node.js application:

| `varexpress = require('express')varhelmet = require('helmet')varapp = express()app.use(helmet())` |
| :--- |


Lets look at what these headers do.

## X-DNS-Prefetch-Control {#SecurityVulnerabilitiesAndHowToHandleThemInNode.js-X-DNS-Prefetch-Control}

What dnsPrefetchControl prevents: disclosure attacks

Whenever an HTTP request is made, a DNS resolution must occur to resolve the ip address of the domain being requested \(if not already cached\). What the X-DNS-Prefetch-Control header does \(if enabled\) is to allow the browser to do DNS resolution of files \(e.g. CSS, Javascript, images, etc.\) and external hyperlinks in the background so the DNS will be resolved by the time the resources are needed. This will reduce the latency of a page load due to a user click because the DNS resolution has already completed. This is especially beneficial for mobile and low-bandwidth browsing where the latency of DNS resolutions can affect performance.

The downside of prefetching is privacy-related. The browser will be running multiple DNS resolutions without the user actively making those requests. If these DNS resolutions are being tracked \(e.g. logs or some other means\) a malicious attacker can gather more information about what the user is looking at and searching for \(disclosure attack\). helmet will disable DNS prefetching by default to prevent this kind of attack.

## X-Frame-Options {#SecurityVulnerabilitiesAndHowToHandleThemInNode.js-X-Frame-Options}

What frameguard prevents: clickjacking

Clickjacking is an attack where a webpage on one domain will iframe in a webpage from another domain. The parent page will cleverly sit under the iframe \(opacity set to 0\) so a link or button will lay right under some clickable input element inside the iframe. The user will click with the intention of doing one thing, but they will end up unintentionally doing what the attacker wants them to do. An example of this kind of attack \(perhaps a little unimaginative\) might be if the user is logged into their Netflix account. The user will open the malicious page which will obscure the users account page. The "Like" button they see lies right on top of the "Cancel Subscription" button, which the user will never see. After clicking the button, the subscription will be closed.

To prevent this kind of attack from happening to your site you can set the X-Frame-Options header value to DENY or SAMEORIGIN. DENY will prevent any page in your application from being iframed in. SAMEORIGIN will only allow pages on the same domain to iframe in another page. helmet will set X-Frame-Options to SAMEORIGIN by default.



